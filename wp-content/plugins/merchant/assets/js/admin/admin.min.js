((m,h,u,p)=>{var f={},v=new URLSearchParams(h.location.search).get("module");function g(e){return"string"==typeof e&&!isNaN(e)&&!isNaN(parseFloat(e))}m(u).ready(function(){var e=m(".merchant-module-page-ajax-form"),a=m(".merchant-module-page-ajax-header"),n=(m(".merchant-module-save-button"),m(".merchant-module-page-content").on("change keypress change.merchant",function(){m(this).is(".merchant-module-question-answer-textarea, .merchant-license-code-input")||f.show_save||(a.addClass("merchant-show"),a.removeClass("merchant-saving"),f.show_save=!0),c.initFlag()}),e.ajaxForm({beforeSubmit:function(){a.addClass("merchant-saving")},success:function(){var t;a.removeClass("merchant-show"),f.show_save=!1,m(".merchant-module-action").hasClass("merchant-enabled")||((t=m(".merchant-module-alert")).addClass("merchant-show"),m(u).off("click.merchant-alert-close"),m(u).on("click.merchant-alert-close",function(e){m(e.target).closest(".merchant-module-alert-wrapper").length||(t.removeClass("merchant-show"),m(u).off("click.merchant-alert-close"))})),m(u).trigger("save.merchant",[v])}}),m(".merchant-module-question-answer-button")),i=m(".merchant-module-question-answer-textarea"),e=(i.on("input",function(){n.prop("disabled",""===m(this).val().trim())}),n.on("click",function(e){e.preventDefault();var t,e=i.val();e.trim()?(t=m(this),m(".merchant-module-question-answer-dropdown").removeClass("merchant-show"),m(".merchant-module-question-thank-you-dropdown").addClass("merchant-show"),h.wp.ajax.post("merchant_module_feedback",{subject:i.attr("data-subject"),message:e,module:t.closest(".merchant-module-action").find(".merchant-module-page-button-action-activate").data("module"),nonce:h.merchant.nonce})):alert("Please provide the required information.")}),m(".merchant-module-page-button-action-activate").on("click",function(e){if(e.preventDefault(),m(this).hasClass("merchant-module-deactivated-by-bp"))return!1;m(".merchant-module-question-list-dropdown").removeClass("merchant-show"),m(".merchant-module-question-answer-dropdown").removeClass("merchant-show"),m(".merchant-module-question-answer-form").removeClass("merchant-show"),m(".merchant-module-question-answer-title").removeClass("merchant-show"),m(".merchant-module-question-thank-you-dropdown").removeClass("merchant-show"),m(".merchant-module-question-answer-textarea").val(""),h.wp.ajax.post("merchant_module_activate",{module:m(this).data("module"),nonce:h.merchant.nonce}).done(function(){m("body").removeClass("merchant-module-disabled").addClass("merchant-module-enabled"),m(".merchant-module-action").addClass("merchant-enabled")})}),m(".merchant-module-page-button-action-deactivate").on("click",function(e){e.preventDefault(),h.wp.ajax.post("merchant_module_deactivate",{module:m(this).data("module"),nonce:h.merchant.nonce}).done(function(){m("body").removeClass("merchant-module-enabled").addClass("merchant-module-disabled"),m(".merchant-module-action").removeClass("merchant-enabled"),m(".merchant-module-question-list-dropdown").addClass("merchant-show")})}),m(".merchant-module-question-list-dropdown li").on("click",function(e){n.prop("disabled",""===i.val().trim());var t=m(this),a=t.data("answer-target"),a=m('[data-answer-title="'+a+'"]');a.length?(a.addClass("merchant-show").siblings().removeClass("merchant-show"),m(".merchant-module-question-answer-dropdown").addClass("merchant-show"),m(".merchant-module-question-answer-textarea").attr("data-subject",t.text().trim())):(m(".merchant-module-question-thank-you-dropdown").addClass("merchant-show"),m(".merchant-module-question-answer-dropdown").removeClass("merchant-show")),m(".merchant-module-question-answer-textarea").val(""),m(".merchant-module-question-list-dropdown").removeClass("merchant-show")}),m(".merchant-module-dropdown-close").on("click",function(e){e.preventDefault(),m(this).closest(".merchant-module-dropdown").removeClass("merchant-show")}),m(".merchant-module-page-button-deactivate").on("click",function(e){e.preventDefault();m(this);var t=m(".merchant-module-deactivate-dropdown");t.toggleClass("merchant-show"),m(u).off("click.merchant-close"),m(u).on("click.merchant-close",function(e){m(e.target).closest(".merchant-module-deactivate").length||(t.removeClass("merchant-show"),m(u).off("click.merchant-close"))})}),m(".merchant-range").each(function(){var e=m(this),n=e.find(".merchant-range-input"),i=e.find(".merchant-range-number-input");n.on("change input merchant.range merchant-init.range",function(e){var t=m(this),e=("merchant"===e.type?i:t).val()||0,a=t.attr("min")||0,a=(e-a)/((t.attr("max")||1)-a)*100;m("body").hasClass("rtl")?t.css({background:"linear-gradient(to left, #3858E9 0%, #3858E9 "+a+"%, #ddd "+a+"%, #ddd 100%)"}):t.css({background:"linear-gradient(to right, #3858E9 0%, #3858E9 "+a+"%, #ddd "+a+"%, #ddd 100%)"}),n.val(e),i.val(e)}).trigger("merchant-init.range"),i.on("change input blur",function(){n.hasClass("merchant-range-input")&&n.val(m(this).val()).trigger("merchant.range")})}),m(u).on("click",".merchant-module-page-setting-field-hidden-desc-trigger",function(){var e=m(this),t=(e.toggleClass("expanded"),e.attr("data-show-text")),a=e.attr("data-hidden-text");m(this).find("span:first").text(e.text()===t?a:t),m(this).closest(".merchant-module-page-setting-field").find(".merchant-module-page-setting-field-hidden-desc").stop(!0,!0).slideToggle("fast")}),{init:function(e){this.events()},events:function(){m(u).on("click",".merchant-flexible-content .merchant-toggle-switch .toggle-switch-label span",function(){var e=m(this).closest(".merchant-toggle-switch").find(".toggle-switch-checkbox");e.prop("checked",!e.prop("checked"))}).trigger("merchant.change")}});({init:function(){this.initiate_datepicker(),this.events()},initiate_datepicker:function(){var e=m(".merchant-module-page-setting-field .merchant-datetime-field");0!==e.length&&e.each(function(a){var n=m(this).find("input"),i={locale:JSON.parse(merchant_datepicker_locale),selectedDates:[n.val()?new Date(n.val()):""],onSelect:function(e){e.date;var t=e.formattedDate;void 0===t&&(e.datepicker.$el.value=""),n.trigger("change.merchant"),n.trigger("change.merchant-datepicker",[t,n,i,a])}},e=m(this).data("options"),e=(e.buttons=["clear"],e&&(e.minDate!==p&&"today"===e.minDate&&(e.minDate=new Date,e.timeZone!==p)&&""!==e.timeZone&&(e.minDate=new Date(e.minDate.toLocaleString("en-US",{timeZone:e.timeZone}))),i=Object.assign(i,e)),new AirDatepicker(n.getPath(),i));n.attr("readonly",!0),m(u).trigger("initiated.merchant-datepicker",[e,n,i,a])})},events:function(){var e=this;m(u).on("merchant-flexible-content-added",function(){e.initiate_datepicker()})}}).init();({init:function(e){this.events()},events:function(){var a=this;m(".merchant-sortable").each(function(){var e=m(this),t=e.find(".merchant-sortable-input");m(e.find("ul.merchant-sortable-list").first()).sortable({update:function(){t.val(a.sortableGetNewVal(e)).trigger("change.merchant")}}).disableSelection().find("li").each(function(){m(this).find("i.visibility").click(function(){m(this).toggleClass("dashicons-visibility-faint").parents("li:eq(0)").toggleClass("invisible")})}).click(function(){m(event.target).hasClass("dashicons-visibility")&&t.val(a.sortableGetNewVal(e)).trigger("change.merchant")})})},sortableGetNewVal:function(e){var e=m(e.find("li")),t=[];return _.each(e,function(e){m(e).hasClass("invisible")||t.push(m(e).data("value"))}),JSON.stringify(t)}}).init(),e.init(),m(u).on("merchant-flexible-content-added",function(e,t){t=t.find(".merchant-sortable-repeater-control").find(".merchant-sortable-repeater.sortable");o.makeFieldsSortable(t)});var r,o={init:function(e){var n=this;m(".merchant-sortable-repeater-control").each(function(){var e=JSON.parse(m(this).find(".merchant-sortable-repeater-input").val()),t=e.length;if(0<t&&(m(this).find(".repeater-input").val(e[0]),1<t))for(var a=1;a<t;++a)n.appendRow(m(this),e[a])}),this.events()},events:function(){var t=this;m(u).on("click",".merchant-sortable-repeater.sortable .customize-control-sortable-repeater-delete",function(e){e.preventDefault(),m(this).parent().slideUp("fast",function(){var e=m(this).parent().parent();m(this).remove(),t.getAllInputs(e)}),m(u).trigger("merchant-sortable-repeater-item-deleted")}),m(u).on("click",".customize-control-sortable-repeater-add",function(e){e.preventDefault(),t.appendRow(m(this).parent()),t.getAllInputs(m(this).parent())}),m(u).on("change",".merchant-sortable-repeater.sortable",function(){t.getAllInputs(m(this).parent())}),m(u).on("focusout",".merchant-sortable-repeater.sortable .repeater-input",function(){t.getAllInputs(m(this).parent())})},appendRow:function(e){var t='<div class="repeater" style="display:none"><input type="text" value="'+(1<arguments.length&&arguments[1]!==p?arguments[1]:"")+'" class="repeater-input" /><span class="dashicons dashicons-menu"></span><a class="customize-control-sortable-repeater-delete" href="#"><span class="dashicons dashicons-no-alt"></span></a></div>',t=(e.find(".sortable").append(t),e.find(".sortable").find(".repeater:last"));t.slideDown("slow",function(){m(this).find("input").focus()}),this.makeFieldsSortable(e.find(".sortable")),m(u).trigger("merchant-sortable-repeater-item-added",[t,e.find(".sortable")])},makeFieldsSortable:function(a){a.hasClass("disable-sorting")||a.sortable({update:function(e,t){o.getAllInputs(a.parent())}})},getAllInputs:function(e){var t=e.find(".repeater-input").map(function(){return m(this).val()}).toArray();t.length||t.push(""),e.find(".merchant-sortable-repeater-input").val(JSON.stringify(t)),e.find(".merchant-sortable-repeater-input").trigger("change"),e.find(".merchant-sortable-repeater-input").trigger("sortable.repeater.change")}},c=(o.init(),{init:function(){this.initAccordion(),this.initFlag()},initAccordion:function(){m(".merchant-group-field.has-accordion").each(function(){var e=m(this);e.accordion({collapsible:!0,header:"> .title-area",heightStyle:"content",active:!!e.hasClass("open")&&0})})},initFlag:function(){m(".merchant-group-field.has-flag").each(function(){var e=m(this),t=e.data("id"),t=e.find(".merchant-field-".concat(t,"_status select")),a=t.val(),t=t.find("option:selected").text();e.find(".field-status").removeClass("hidden active inactive").text(t).addClass(a)})}}),e={accordion:null,activePopupContainer:null,init:function(){this.initAccordion(),this.events(),this.makeSelectedReviewsSortable(m(".merchant-reviews-selector").not(".layouts .merchant-reviews-selector"))},events:function(){var a=this;m(u).on("input",".merchant-reviews-selector .products-search",a.ajaxSearch.bind(a)),m(u).on("change",'.merchant-reviews-selector .product-review input[type="checkbox"]',a.toggleReview.bind(a)),m(u).on("click",".merchant-reviews-selector .review-photo img",a.requestReviewImages.bind(a)),m(u).on("click",".review-photos-popup .overlay",a.dismissImagesGallery.bind(a)),m(u).on("click",".merchant-reviews-selector .product-reviews-load-more button",a.loadMoreReviews.bind(a)),m(u).on("click",".merchant-reviews-selector .popup-trigger",a.initPopUp.bind(a)),m(u).on("click",".merchant-reviews-selector .popup-header .close, .merchant-reviews-selector > .overlay",a.dismissPopUp.bind(a)),m(u).on("click",".merchant-reviews-selector .product-review-delete",a.deleteSelectedReview.bind(a)),m(u).on("keyup",function(e){"Escape"!==e.key||a.dismissImagesGallery()||a.dismissPopUp(a)}),m(u).on("merchant-flexible-content-added",function(e,t){a.makeSelectedReviewsSortable(),a.initAccordion()})},makeSelectedReviewsSortable:function(){var e=0<arguments.length&&arguments[0]!==p?arguments[0]:m(u).find(".merchant-reviews-selector").not(".layouts .merchant-reviews-selector"),a=this;e.find(".selected-reviews .product-reviews").sortable({axis:"y",cursor:"move",helper:"original",handle:".product-review-move",cancel:"",placeholder:"placeholder",update:function(e,t){t=t.item.closest(".merchant-reviews-selector");a.saveModifications(t)},start:function(e,t){t.placeholder.height(t.item.height())}})},deleteSelectedReview:function(e){var e=m(e.target).closest(".product-review"),t=e.closest(".merchant-reviews-selector");e.remove(),this.saveModifications(t),this.updateSelectedReviewsCheckboxState(t),this.countSelectedReviewsInProduct(t)},ajaxSearch:function(e){var t=this,e=m(e.target),a=e.closest(".merchant-reviews-selector"),n=a.find(".popup-header");(0===e.val().length||3<=e.val().length)&&m.ajax({url:merchant_admin_options.ajaxurl,type:"POST",data:{action:"merchant_search_reviews",search:e.val(),nonce:merchant_admin_options.ajaxnonce},beforeSend:function(){n.addClass("loading"),t.destroyAccordion(a)},success:function(e){e.success?(n.removeClass("popup-error"),a.find(".products-search-results").html(e.data),t.initAccordion(a)):n.addClass("popup-error")},complete:function(){n.removeClass("loading")},error:function(){n.addClass("popup-error")}})},loadMoreReviews:function(e){var t=this,a=m(e.target).closest(".product-item"),e=a.find(".product-review").length;m.ajax({url:merchant_admin_options.ajaxurl,type:"POST",data:{action:"merchant_load_more_reviews",product_id:a.attr("data-id"),offset:e,nonce:merchant_admin_options.ajaxnonce},beforeSend:function(){a.addClass("loading")},success:function(e){e.success&&(a.find(".product-reviews .reviews-wrapper").append(e.data.reviews),""===e.data.load_more&&t.hideLoadMoreButton(a),t.updateSelectedReviewsCheckboxState(a.closest(".merchant-reviews-selector")),t.countSelectedReviewsInProduct(a.closest(".merchant-reviews-selector")))},complete:function(){a.removeClass("loading")}})},hideLoadMoreButton:function(e){e.find(".product-reviews-load-more").remove()},initPopUp:function(e){var e=m(e.target).closest(".merchant-reviews-selector"),t=e.find(".selector-popup"),a=e.find(".overlay");t.addClass("active"),a.addClass("active"),this.activePopupContainer=e},dismissPopUp:function(){var e,t=this.activePopupContainer;null!==t&&(e=t.find(".selector-popup"),t=t.find(".overlay"),e.removeClass("active"),t.removeClass("active"),this.activePopupContainer=null)},initAccordion:function(){var e=0<arguments.length&&arguments[0]!==p?arguments[0]:m(u).find(".merchant-reviews-selector"),t=this;e.each(function(){var a=m(this).find(".popup-content .product-item.product-item-has-reviews");a.each(function(){a.accordion({collapsible:!0,heightStyle:"content",icons:!1,active:!!a.hasClass("opened")&&0,activate:function(e,t){t.newPanel.length?t.newPanel.parent().addClass("opened"):a.removeClass("opened")}})}),a.find("a").on("click",function(e){e.stopPropagation()}),t.updateSelectedReviewsCheckboxState(m(this)),t.countSelectedReviewsInProduct(m(this))})},destroyAccordion:function(e){e.find(".selector-popup .product-item.product-item-has-reviews").each(function(){m(this).hasClass("ui-accordion")&&m(this).accordion("destroy")})},toggleReview:function(e){var t=this,a=m(e.target).prop("checked"),n=m(e.target).closest(".merchant-reviews-selector"),e=m(e.target).closest(".product-review"),i=e.attr("data-id"),r=n.find(".selected-reviews .product-reviews"),i=r.find('.product-review[data-id="'.concat(i,'"]'));a?0===i.length&&(a=e.clone(),r.append(a),t.makeSelectedReviewsSortable()):i.remove(),setTimeout(function(){t.saveModifications(n)},150)},saveModifications:function(e){var t=e.find(".review-saved-ids"),a=e.find(".selected-reviews .product-reviews").find(".product-review"),n=[];a.each(function(){var e=m(this).attr("data-id");n.push(e)}),t.val(n.join(",")),t.trigger("change"),this.updateSelectedReviewsCheckboxState(e),this.countSelectedReviewsInProduct(e)},updateSelectedReviewsCheckboxState:function(a){var e=a.find(".selector-popup"),t=a.find(".review-saved-ids"),e=e.find(".product-review"),n=t.val().split(",");e.each(function(){var e=m(this).attr("data-id"),t=a.find('.product-review[data-id="'.concat(e,'"] input[type="checkbox"]'));n.includes(e)?t.prop("checked",!0):t.prop("checked",!1)})},countSelectedReviewsInProduct:function(e){var t=e.find(".selector-popup .product-item"),a=e.find(".review-saved-ids").val().split(",");t.each(function(){var t=0,e=m(this);e.find(".product-review").each(function(){var e=m(this).attr("data-id");a.includes(e)&&t++}),e.find(".selected-reviews-count .counter").text(t)})},requestReviewImages:function(e){var t=m(e.target).closest(".product-review"),a=m(e.target),e=t.attr("data-id");m.ajax({url:merchant_admin_options.ajaxurl,type:"POST",data:{action:"merchant_get_review_images",review_id:e,nonce:merchant_admin_options.ajaxnonce},beforeSend:function(){a.addClass("loading")},success:function(e){e.success&&(m("body").append(e.data),setTimeout(function(){m("body").find(".review-photos-popup").addClass("active")},300))},complete:function(){a.removeClass("loading")}})},dismissImagesGallery:function(){var e=m("body").find(".review-photos-popup");return!!e.length&&(e.removeClass("active"),setTimeout(function(){e.remove()},300),!0)}};({init:function(e){var n=this;m(".merchant-flexible-content-control").each(function(){var e=m(this).hasClass("has-accordion"),a=m(this).find(".merchant-flexible-content");e?a.accordion({collapsible:!0,header:function(e){return e.find(".layout__inner > .layout-header")},heightStyle:"content"}).sortable({axis:"y",cursor:"move",helper:"original",handle:".customize-control-flexible-content-move",stop:function(e,t){a.trigger("merchant.sorted"),n.refreshNumbers(a),a.accordion("refresh")}}):a.sortable({axis:"y",cursor:"move",helper:"original",handle:".customize-control-flexible-content-move",stop:function(e,t){a.trigger("merchant.sorted"),n.refreshNumbers(a),a.accordion("refresh")}})}),this.updateLayoutTitle(),this.updateDiscountPercentMaxVal(),this.events()},updateLayoutTitle:function(){m(".merchant-flexible-content .layout").each(function(){var e,t=m(this).find(".layout-title[data-title-field]");t.length&&((e=m(this).find(".layout-body .merchant-field-"+t.data("title-field")+" input")).on("change keyup",function(){t.text(m(this).val())}),t.text(e.val()))})},updateDiscountPercentMaxVal:function(){m(".merchant-flexible-content .layout").each(function(){var e=m(this),t=e.find('.merchant-module-page-setting-field[data-id="discount_type"]'),a=e.find('.merchant-module-page-setting-field[data-id="discount_value"]'),e=(a=(a=a.length?a:e.find('.merchant-module-page-setting-field[data-id="discount"]')).length?a:e.find('.merchant-module-page-setting-field[data-id="discount_amount"]'),t.find("input:checked").val());"percentage_discount"===e||"percentage"===e?a.find("input").attr("max",100):a.find("input").removeAttr("max")}),m(".merchant-module-page-setting-fields")},events:function(){var r=this;function a(e){e&&e.length&&e.siblings().find(".layout-actions__inner").slideUp(300)}m(u).on("change",'.merchant-module-page-setting-field[data-id="discount_type"] input',function(){r.updateDiscountPercentMaxVal()}),m(u).on("change","select",function(){var t=m(this).val(),a=m(this).prop("multiple");m(this).find("option").each(function(){var e=m(this).val(),e=a?t.includes(e):e===t;m(this).attr("selected",e)})}),m(".customize-control-flexible-content-add-button").click(function(e){e.preventDefault(),e.stopImmediatePropagation(),1===m(this).parent().find(".customize-control-flexible-content-add-list a").length?m(this).parent().find(".customize-control-flexible-content-add-list a").trigger("click"):m(this).parent().find(".customize-control-flexible-content-add-list").toggleClass("active")}),m(u).on("click",".customize-control-flexible-content-add",function(e){e.preventDefault(),e.stopImmediatePropagation();var e=m(".merchant-flexible-content-control[data-id="+m(this).data("id")+"]"),t=e.find(".layouts"),a=m(this).data("layout"),t=t.find(".layout[data-type="+a+"]").clone(!0),a=e.find(".merchant-flexible-content"),n=a.find(".layout"),e=(t.find("input, select, textarea").each(function(){m(this).data("name")&&m(this).attr("name",m(this).data("name").replace("0",n.length)),m(this).is(":checkbox, :radio")&&m(this).attr("checked")&&m(this).prop("checked",!0)}),t.find(".layout-count").text(n.length+1),a.append(t),a.removeClass("empty"),m(this).parent().removeClass("active"),t.find(".merchant-module-page-setting-field-upload").length&&s(t.find(".merchant-module-page-setting-field-upload")),t.find(".merchant-module-page-setting-field-select_ajax").length&&l(t.find(".merchant-module-page-setting-field-select_ajax")),m(this).closest(".merchant-flexible-content-control"));e.hasClass("has-accordion")&&(e.find(".merchant-flexible-content").accordion("refresh"),e.find(".merchant-flexible-content").accordion("option","active",-1)),c.init(),m(u).trigger("merchant-flexible-content-added",[t]),r.updateLayoutTitle(),r.updateDiscountPercentMaxVal()}),m(u).on("click",".customize-control-flexible-content-duplicate",function(e){e.preventDefault(),e.stopImmediatePropagation();var t,n,e=m(this),a=e.closest(".merchant-flexible-content-control[data-id="+e.data("id")+"]"),i=null==a?void 0:a.find(".merchant-flexible-content");a.length&&i.length&&(e=e.closest(".layout")).length&&(e.find(".layout-actions__inner").hide(),t=e.clone(),i.find(".layout"),n=e.find(".layout-count").text(),t.find("input, select, textarea").each(function(){var e,t=m(this),a=t.attr("name");a&&(e=a.split("[")[0],a=a.match(/\[(.*?)\]/g))&&1<a.length&&(a[1]="["+n+"]",e="".concat(e).concat(a.join("")),t.attr("name",e))}),t.find("select").each(function(){m(this).hasClass("select2-hidden-accessible")&&(m(this).removeClass("select2-hidden-accessible").removeAttr("data-live-search").removeAttr("data-select2-id").removeAttr("aria-hidden").removeAttr("tabindex"),m(this).nextAll(".select2-container").remove(),m(this).select2())}),t.find(".layout-body").removeAttr("style"),t.hide(),t.insertAfter(e),t.fadeIn(),t.find(".merchant-module-page-setting-field-upload").length&&s(t.find(".merchant-module-page-setting-field-upload")),t.find(".merchant-module-page-setting-field-select_ajax").length&&l(t.find(".merchant-module-page-setting-field-select_ajax")),r.refreshNumbers(i),m(u).trigger("merchant-flexible-content-added",[t]),a.hasClass("has-accordion")&&i.accordion("refresh"),r.updateLayoutTitle(),c.init())}),m(u).on("click",".customize-control-flexible-content-delete",function(e){e.preventDefault();var e=m(this).closest(".layout"),t=e.parent(),t=(e.remove(),0===t.find(".layout").length&&t.addClass("empty"),r.refreshNumbers(t),m(u).trigger("merchant-flexible-content-deleted",[e]),m(this).closest(".merchant-flexible-content-control"));t.hasClass("has-accordion")&&t.find(".merchant-flexible-content").accordion("refresh"),m(u).trigger("change.merchant")}),m(u).on("click",".layout-actions__toggle",function(e){e.preventDefault(),a(m(this).closest(".layout")),m(this).closest(".layout-actions").find(".layout-actions__inner").stop().slideToggle(300)}),m(u).on("click",".layout-header",function(){a(m(this).closest(".layout"))}),m(u).on("merchant-flexible-content-added",function(e,t){a(t)})},refreshNumbers:function(e){e.find(".layout").each(function(e){var t=m(this).find(".layout-count").text(),a=parseInt(t)-1;m(this).find(".layout-count").text(e+1),m(this).find("input, select, textarea").each(function(){m(this).attr("name")&&m(this).attr("name",m(this).attr("name").replace("["+a+"]","[*refreshed*"+e+"]"))})}),e.find(".layout").each(function(e){m(this).find("input, select, textarea").each(function(){var e=m(this).attr("name");e&&m(this).attr("name",e.replace("*refreshed*",""))})}),e.parent().find("input").trigger("change.merchant")}}).init(),c.init(),e.init(),m(u).on("keyup",".merchant-module-page-setting-field-products_selector .merchant-search-field",function(){clearTimeout(r);var e,t,a,n=[],i=(!m(this).closest('[data-id="excluded_products"]').length||"categories"!==(t=(e=m(this).closest(".layout")).find(".merchant-field-rules_to_apply select").val()||e.find(".merchant-field-rules_to_display select").val()||e.find(".merchant-field-display_rules select").val())&&"by_category"!==t||(n=e.find(".merchant-field-category_slugs select").val()||e.find(".merchant-field-product_cats select").val()),m(this).closest(".merchant-products-search-container"));""!==m(this).val()?(i.find(".merchant-searching").addClass("active"),a={action:"merchant_admin_products_search",nonce:merchant_admin_options.ajaxnonce,keyword:m(this).val(),product_types:m(this).data("allowed-types"),ids:i.find(".merchant-selected-products").val(),categories:n},r=setTimeout(function(){m.post(merchant_admin_options.ajaxurl,a,function(e){var t=i.find(".merchant-selections-products-preview");t.show(),t.html(e),i.find(".merchant-searching").removeClass("active")})},250)):i.find(".merchant-selections-products-preview").html("").hide()}),m(u).on("click touch",".merchant-module-page-setting-field-products_selector .merchant-selections-products-preview li",function(){var e=m(this).closest(".merchant-products-search-container"),t=e.find(".merchant-selected-products"),a=t.val(),n="multiple"===e.data("multiple");0<e.find(".merchant-selected-products-preview ul li").length&&!n&&(e.find(".merchant-selected-products-preview ul li").remove(),t.val("").change()),m(this).children(".remove").attr("aria-label","Remove").html("×"),e.find(".merchant-selected-products-preview ul").append(m(this)),e.find(".merchant-selections-products-preview").html("").hide(),e.find(".merchant-search-field").val("").change(),""===a?t.val(m(this).data("id")):(n?((e=a.split(",")).push(m(this).data("id")),t.val(e.join(","))):t.val(m(this).data("id"))).change()}),m(u).on("click touch",".merchant-selected-products-preview .remove",function(){var e=m(this);if(confirm(merchant_admin_options.product_delete_confirmation_message)){var t=e.closest(".merchant-products-search-container").find(".merchant-selected-products"),a=e.parent().data("id"),n=(e.parent().remove(),t.val().split(","));if(0<n.length)for(var i in n)parseInt(n[i])===parseInt(a)&&n.splice(i,1);t.val(n.join(",")).change(),t.trigger("change.merchant")}}),m(u).on("merchant-admin-check-fields merchant-flexible-content-added",function(){m(".merchant-module-page-setting-field").each(function(){var e=m(this);if(e.data("condition")&&e.data("condition").length){var t=e.data("condition"),a=m(this).closest(".layout-body").find('input[name*="'+t[0]+'"],select[name*="'+t[0]+'"]');if((a=a.length?a:m('input[name="merchant['+t[0]+']"],select[name="merchant['+t[0]+']"]')).length){var n,i=!1;switch(t[1]){case"==":"radio"!==a.attr("type")&&"checkbox"!==a.attr("type")||(n=a.parent().find("input:checked")).length&&n.val()===t[2]&&(i=!0),a.is("select")&&a.val()==t[2]&&(i=!0);break;case"any":"radio"!==a.attr("type")&&"checkbox"!==a.attr("type")||(n=a.parent().find("input:checked")).length&&t[2].split("|").includes(n.val())&&(i=!0),a.is("select")&&t[2].split("|").includes(a.val())&&(i=!0)}i?e.removeClass("merchant-hide").addClass("merchant-show"):e.removeClass("merchant-show").addClass("merchant-hide")}}})}).trigger("merchant.change"),m(u).on("merchant-admin-check-fields merchant-flexible-content-added change keyup",function(){m(u).find(".merchant-module-page-setting-field").each(function(){var e=m(this);e.data("conditions")&&(function e(t){var a=1<arguments.length&&arguments[1]!==p&&arguments[1];var n=!1;if("relation"in t){var i=t.relation.toUpperCase();if("OR"===i)for(var r=0;r<t.terms.length;r++){var o=t.terms[r];if(n=e(o,a))return!0}else if("AND"===i){for(var c=0,s=0;s<t.terms.length;s++){var l=t.terms[s];e(l,a)&&c++}c===t.terms.length&&(n=!0)}}else{var d,i="",h=(i="terms"in t?t.terms[0]:t,m('input[name="merchant['+i.field+']"],select[name="merchant['+i.field+']"]')),u=(h.length||0<(d=a.closest(".layout-body")).length&&(h=d.find(".merchant-field-"+i.field).find("input, select")),(h=(h=h.length?h:m('input[name="merchant['+i.field+'][]"],select[name="merchant['+i.field+'][]"]')).length?h:m(".merchant-group-fields-container").find(".merchant-field-"+i.field+' input[name*="'+i.field+'"],.merchant-field-'+i.field+' select[name*="'+i.field+'"]')).val());"checkbox"===h.attr("type")&&(u=h.is(":checked")),"radio"===h.attr("type")&&(u=h.filter(":checked").val()),"checkbox"===h.attr("type")&&1<h.length&&(u=[],h.each(function(){m(this).is(":checked")&&u.push(m(this).val())})),g(u)&&(u=Number(u)),Array.isArray(i.value)&&(i.value=i.value.map(function(e){return g(e)?Number(e):e})),("==="===i.operator&&u===i.value||"!=="===i.operator&&u!==i.value||">"===i.operator&&u>i.value||"<"===i.operator&&u<i.value||">="===i.operator&&u>=i.value||"<="===i.operator&&u<=i.value||"in"===i.operator&&i.value.includes(u)||"!in"===i.operator&&!i.value.includes(u)||"contains"===i.operator&&Array.isArray(u)&&u.includes(i.value)||"!contains"===i.operator&&Array.isArray(u)&&!u.includes(i.value))&&(n=!0)}return n}(e.data("conditions"),e)?e.removeClass("merchant-hide").addClass("merchant-show"):e.removeClass("merchant-show").addClass("merchant-hide"))})}).trigger("merchant.change"),m(u).on("change",".merchant-module-page-setting-field",function(){m(u).trigger("merchant-admin-check-fields")}).trigger("merchant.change"),m(u).trigger("merchant-admin-check-fields"),m(u).on("merchant-admin-check-color-fields merchant-flexible-content-added",function(){m(".merchant-color").each(function(){var a,e=m(this),n=e.find(".merchant-color-picker"),i=e.find(".merchant-color-input"),r=!1;n.off("click").on("click",function(e){e.preventDefault(),e.stopPropagation();var t=m("body,html");t.addClass("merchant-height-auto"),r?a.setColor(i.val()):((a=new Pickr({el:n.get(0),container:"body",theme:"merchant",appClass:"merchant-pcr-app",default:i.val()||n.data("default-color")||"#212121",swatches:["#000000","#F44336","#E91E63","#673AB7","#03A9F4","#8BC34A","#FFEB3B","#FFC107","#FFFFFF"],sliders:"h",useAsButton:!0,components:{hue:!0,preview:!0,opacity:!0,interaction:{input:!0,clear:!0}},i18n:{"btn:clear":"Default"}})).on("change",function(e){e=(1===e.a?(a.setColorRepresentation("HEX"),e.toHEXA()):(a.setColorRepresentation("RGBA"),e.toRGBA())).toString(0);n.css({"background-color":e}),i.val()!==e&&i.val(e).trigger("change.merchant"),m(u).trigger("merchant-color-picker-updated",[e,i])}),a.on("clear",function(){var e=n.data("default-color");e?a.setColor(e):(n.css({"background-color":"white"}),i.val(""))}),a.on("hide",function(){t.removeClass("merchant-height-auto")}),n.data("pickr",a),setTimeout(function(){a.show()},200),r=!0)}),i.on("change keyup",function(){var e=m(this).val();n.css({"background-color":e})})})}),m(u).trigger("merchant-admin-check-color-fields");({init:function(){this.events()},events:function(){var l=this;m(u).on("click",".merchant-create-page-control-button",function(e){e.preventDefault();var t=m(this),a=t.parent().find(".merchant-create-page-control-create-message"),n=t.parent().find(".merchant-create-page-control-success-message"),e=(t.text(),t.data("creating-text")),i=(t.data("created-text"),t.data("page-title")),r=t.data("page-meta-key"),o=t.data("page-meta-value"),c=t.data("option-name"),s=t.data("nonce");if(!i)return!1;m(this).text(e),m(this).attr("disabled",!0),m.ajax({type:"post",url:ajaxurl,data:{action:"merchant_create_page_control",page_title:i,page_meta_key:r,page_meta_value:o,option_name:c,nonce:s},success:function(e){l.ajaxResponseHandler(e,t,n,a)}})})},ajaxResponseHandler:function(e,t,a,n){"success"===e.status&&(e=a.find("a").attr("href").replace("?post=&","?post="+e.page_id+"&"),a.find("a").attr("href",e),a.css("display","block"),n.remove(),t.remove())}}).init(),m(".merchant-module-page-setting-field-gallery").each(function(){var n,i=m(this),e=i.find(".merchant-gallery-button"),r=i.find(".merchant-gallery-input"),o=i.find(".merchant-gallery-images"),t=i.find(".merchant-gallery-remove");o.sortable({helper:"original",update:function(e,t){var a=[];o.find(".merchant-gallery-image").each(function(){a.push(m(this).data("item-id"))}),r.val(a.join(",")).trigger("change")}});t.on("click",function(e){e.preventDefault(),m(this).parent().remove();var t=[];o.find(".merchant-gallery-image").each(function(){t.push(m(this).data("item-id"))}),r.val(t.join(",")).trigger("change")}),e.on("click",function(e){m(this);var t=r.val(),a=t?"edit":"add";e.preventDefault(),void 0!==h.wp&&h.wp.media&&h.wp.media.gallery&&("add"==a?(n=h.wp.media({library:{type:"image"},frame:"post",state:"gallery",multiple:!0})).open():n=h.wp.media.gallery.edit('[gallery ids="'+t+'"]'),n.on("update",function(e){o.empty();e=e.models.map(function(e){var e=e.toJSON(),t=(e.sizes&&e.sizes.thumbnail&&e.sizes.thumbnail.url?e.sizes.thumbnail:e).url;return o.append('<div class="merchant-gallery-image" data-item-id="'+e.id+'"><i class="merchant-gallery-remove dashicons dashicons-no-alt"></i><img src="'+t+'" /></div>'),e.id});r.val(e.join(",")).trigger("change"),i.find(".merchant-gallery-remove").on("click",function(e){e.preventDefault(),m(this).parent().remove();var t=[];o.find(".merchant-gallery-image").each(function(){t.push(m(this).data("item-id"))}),r.val(t.join(",")).trigger("change")})}))})});var s=function(e){var n,i=e,e=i.find(".merchant-upload-button"),r=i.find(".merchant-upload-input"),o=i.find(".merchant-upload-wrapper");i.find(".merchant-upload-remove").on("click",function(e){e.preventDefault(),m(this).parent().remove(),r.val("").trigger("change")}),e.on("click",function(e){e.preventDefault(),void 0!==h.wp&&h.wp.media&&((n=n||h.wp.media({library:{type:"image"}})).open(),n.on("select",function(){o.empty();var e=n.state().get("selection").first().attributes,t=(e.sizes&&e.sizes.thumbnail&&e.sizes.thumbnail.url?e.sizes.thumbnail:e).url,a=e.sizes?JSON.stringify(e.sizes):"";o.append('<div class="merchant-upload-image" data-sizes=\''+a+'\'><i class="merchant-upload-remove dashicons dashicons-no-alt"></i><img src="'+t+'" /></div>'),r.val(e.id).trigger("change"),i.find(".merchant-upload-button-drag-drop").hide(),i.find(".merchant-upload-remove").on("click",function(e){e.preventDefault(),m(this).parent().remove(),r.val("").trigger("change"),i.find(".merchant-upload-button-drag-drop").show()})}))})},l=(m(".merchant-module-page-setting-field-upload:not(.template)").each(function(){s(m(this))}),jQuery.each(["dragenter","dragover","dragleave","drop"],function(e,t){m(u).on(t,".merchant-upload-button-drag-drop",function(e){e.preventDefault(),e.stopPropagation()})}),m(u).on("dragenter",".merchant-upload-button-drag-drop",function(e){m(this).closest(".merchant-module-page-setting-field-upload").find(".merchant-upload-button").click()}),function(e){var t=e.find("select"),a=t.data("source"),n=h.merchant_admin_options,i={width:"100%",templateSelection:function(e){return e.text.replace(/&nbsp;-*\s*/g,"").trim()}};"post"!==a&&"product"!==a&&"user"!==a||(i.minimumInputLength=1,i.ajax={url:n.ajaxurl,dataType:"json",delay:250,cache:!0,data:function(e){return{action:"merchant_admin_options_select_ajax",nonce:n.ajaxnonce,term:e.term,source:a}},processResults:function(e,t){return e.success?{results:e.data}:{}}}),t.select2(i),e.find(".select2-selection--multiple").append('<span class="merchant-select2-clear"></span>')}),d=(m(".merchant-module-page-setting-field-select_ajax:not(.template)").each(function(){l(m(this))}),m(".merchant-module-page-settings-responsive").each(function(){var e=m(this),a=e.find(".merchant-module-page-settings-devices button"),n=e.find(".merchant-module-page-settings-device-container");a.on("click",function(e){e.preventDefault();var t=m(this).data("device");a.removeClass("active"),n.removeClass("active"),m(this).addClass("active"),n.each(function(){m(this).data("device")===t&&m(this).addClass("active")})})}),m(".merchant-animated-buttons").each(function(){var e,t,a=m(this).find("label"),n=m(".merchant-animation-demo");a.on("click",function(){n.removeClass("merchant-animation-"+e),n.removeClass("merchant-animation-"+t),e=m(this).find("input").attr("value"),setTimeout(function(){n.addClass("merchant-animation-"+e)},100),setTimeout(function(){n.removeClass("merchant-animation-"+e)},1e3)}),a.mouseover(function(){n.removeClass("merchant-animation-"+e),t=m(this).find("input").attr("value"),n.addClass("merchant-animation-"+t)}).mouseout(function(){n.removeClass("merchant-animation-"+t)})}),m(".merchant-notifications-sidebar")),e=(d.length&&(m(".merchant-notifications").on("click",function(e){e.preventDefault();var t=m(this),e=d.find(".merchant-notification:first-child .merchant-notification-date").data("raw-date");d.toggleClass("opened"),t.hasClass("read")||m.post(h.merchant.ajax_url,{action:"merchant_notifications_read",nonce:h.merchant.nonce,latest_notification_date:e},function(e){e.success&&setTimeout(function(){t.addClass("read")},2e3)})}),m(h).on("scroll",function(){60<h.pageYOffset&&(d.addClass("closing"),setTimeout(function(){d.removeClass("opened"),d.removeClass("closing")},300))}),m(".merchant-notifications-sidebar-close").on("click",function(e){e.preventDefault(),d.addClass("closing"),setTimeout(function(){d.removeClass("opened"),d.removeClass("closing")},300)})),m(".merchant-tabs-nav")),t=(e.length&&e.each(function(){var a=m(this).data("tab-wrapper-id");m(this).find(".merchant-tabs-nav-link").on("click",function(e){e.preventDefault();var e=m(this).closest(".merchant-tabs-nav").find(".merchant-tabs-nav-link"),t=m(this).data("tab-to"),e=(e.each(function(){m(this).closest(".merchant-tabs-nav-item").removeClass("active")}),m(this).closest(".merchant-tabs-nav-item").addClass("active"),m('.merchant-tab-content-wrapper[data-tab-wrapper-id="'+a+'"]'));e.find("> .merchant-tab-content").removeClass("active"),e.find('> .merchant-tab-content[data-tab-content-id="'+t+'"]').addClass("active")})}),m(".merchant-module-alert"));t.length&&t.find(".merchant-module-alert-close").on("click",function(e){e.preventDefault(),t.removeClass("merchant-show"),m(u).off("click.merchant-alert-close")})})})(jQuery,window,document),jQuery.fn.extend({getPath:function(){var c=[];return this.each(function(e,t){for(var a,n=jQuery(t);n.length;){var i=n.get(0);if(!(r=i.localName))break;var r=r.toLowerCase(),o=n.parent();1<o.children(r).length&&0<(e=o.children().index(i)+1)&&(r+=":nth-child("+e+")"),a=r+(a?" > "+a:""),n=o}c.push(a)}),c.join(",")}});