"use strict";!function(u,h,m,f){var p={},g=new URLSearchParams(h.location.search).get("module");function v(e){return"string"==typeof e&&!isNaN(e)&&!isNaN(parseFloat(e))}u(m).ready(function(){var e=u(".merchant-module-page-ajax-form"),a=u(".merchant-module-page-ajax-header"),n=(u(".merchant-module-save-button"),u(".merchant-module-page-content").on("change keypress change.merchant",function(){u(this).is(".merchant-module-question-answer-textarea, .merchant-license-code-input")||p.show_save||(a.addClass("merchant-show"),a.removeClass("merchant-saving"),p.show_save=!0),o.initFlag()}),e.ajaxForm({beforeSubmit:function(){a.addClass("merchant-saving")},success:function(){var t;a.removeClass("merchant-show"),p.show_save=!1,u(".merchant-module-action").hasClass("merchant-enabled")||((t=u(".merchant-module-alert")).addClass("merchant-show"),u(m).off("click.merchant-alert-close"),u(m).on("click.merchant-alert-close",function(e){u(e.target).closest(".merchant-module-alert-wrapper").length||(t.removeClass("merchant-show"),u(m).off("click.merchant-alert-close"))})),u(m).trigger("save.merchant",[g])}}),u(".merchant-module-question-answer-button")),i=u(".merchant-module-question-answer-textarea"),e=(i.on("input",function(){n.prop("disabled",""===u(this).val().trim())}),n.on("click",function(e){e.preventDefault();var t,e=i.val();e.trim()?(t=u(this),u(".merchant-module-question-answer-dropdown").removeClass("merchant-show"),u(".merchant-module-question-thank-you-dropdown").addClass("merchant-show"),h.wp.ajax.post("merchant_module_feedback",{subject:i.attr("data-subject"),message:e,module:t.closest(".merchant-module-action").find(".merchant-module-page-button-action-activate").data("module"),nonce:h.merchant.nonce})):alert("Please provide the required information.")}),u(".merchant-module-page-button-action-activate").on("click",function(e){if(e.preventDefault(),u(this).hasClass("merchant-module-deactivated-by-bp"))return!1;u(".merchant-module-question-list-dropdown").removeClass("merchant-show"),u(".merchant-module-question-answer-dropdown").removeClass("merchant-show"),u(".merchant-module-question-answer-form").removeClass("merchant-show"),u(".merchant-module-question-answer-title").removeClass("merchant-show"),u(".merchant-module-question-thank-you-dropdown").removeClass("merchant-show"),u(".merchant-module-question-answer-textarea").val(""),h.wp.ajax.post("merchant_module_activate",{module:u(this).data("module"),nonce:h.merchant.nonce}).done(function(){u("body").removeClass("merchant-module-disabled").addClass("merchant-module-enabled"),u(".merchant-module-action").addClass("merchant-enabled")})}),u(".merchant-module-page-button-action-deactivate").on("click",function(e){e.preventDefault(),h.wp.ajax.post("merchant_module_deactivate",{module:u(this).data("module"),nonce:h.merchant.nonce}).done(function(){u("body").removeClass("merchant-module-enabled").addClass("merchant-module-disabled"),u(".merchant-module-action").removeClass("merchant-enabled"),u(".merchant-module-question-list-dropdown").addClass("merchant-show")})}),u(".merchant-module-question-list-dropdown li").on("click",function(e){n.prop("disabled",""===i.val().trim());var t=u(this),a=t.data("answer-target"),a=u('[data-answer-title="'+a+'"]');a.length?(a.addClass("merchant-show").siblings().removeClass("merchant-show"),u(".merchant-module-question-answer-dropdown").addClass("merchant-show"),u(".merchant-module-question-answer-textarea").attr("data-subject",t.text().trim())):(u(".merchant-module-question-thank-you-dropdown").addClass("merchant-show"),u(".merchant-module-question-answer-dropdown").removeClass("merchant-show")),u(".merchant-module-question-answer-textarea").val(""),u(".merchant-module-question-list-dropdown").removeClass("merchant-show")}),u(".merchant-module-dropdown-close").on("click",function(e){e.preventDefault(),u(this).closest(".merchant-module-dropdown").removeClass("merchant-show")}),u(".merchant-module-page-button-deactivate").on("click",function(e){e.preventDefault();u(this);var t=u(".merchant-module-deactivate-dropdown");t.toggleClass("merchant-show"),u(m).off("click.merchant-close"),u(m).on("click.merchant-close",function(e){u(e.target).closest(".merchant-module-deactivate").length||(t.removeClass("merchant-show"),u(m).off("click.merchant-close"))})}),u(".merchant-range").each(function(){var e=u(this),n=e.find(".merchant-range-input"),i=e.find(".merchant-range-number-input");n.on("change input merchant.range merchant-init.range",function(e){var t=u(this),e=("merchant"===e.type?i:t).val()||0,a=t.attr("min")||0,a=(e-a)/((t.attr("max")||1)-a)*100;u("body").hasClass("rtl")?t.css({background:"linear-gradient(to left, #3858E9 0%, #3858E9 "+a+"%, #ddd "+a+"%, #ddd 100%)"}):t.css({background:"linear-gradient(to right, #3858E9 0%, #3858E9 "+a+"%, #ddd "+a+"%, #ddd 100%)"}),n.val(e),i.val(e)}).trigger("merchant-init.range"),i.on("change input blur",function(){n.hasClass("merchant-range-input")&&n.val(u(this).val()).trigger("merchant.range")})}),u(m).on("click",".merchant-module-page-setting-field-hidden-desc-trigger",function(){var e=u(this),t=(e.toggleClass("expanded"),e.attr("data-show-text")),a=e.attr("data-hidden-text");u(this).find("span:first").text(e.text()===t?a:t),u(this).closest(".merchant-module-page-setting-field").find(".merchant-module-page-setting-field-hidden-desc").stop(!0,!0).slideToggle("fast")}),{init:function(e){this.events()},events:function(){u(m).on("click",".merchant-flexible-content .merchant-toggle-switch .toggle-switch-label span",function(){var e=u(this).closest(".merchant-toggle-switch").find(".toggle-switch-checkbox");e.prop("checked",!e.prop("checked"))}).trigger("merchant.change")}});({init:function(){this.initiate_datepicker(),this.events()},initiate_datepicker:function(){var e=u(".merchant-module-page-setting-field .merchant-datetime-field");0!==e.length&&e.each(function(){var a=u(this).find("input"),e={locale:JSON.parse(merchant_datepicker_locale),selectedDates:[a.val()?new Date(a.val()):""],onSelect:function(e){e.date;var t=e.formattedDate;e.datepicker;void 0===t&&a.val(""),a.trigger("change.merchant"),a.trigger("change.merchant-datepicker",[t,a])}},t=u(this).data("options");t.buttons=["clear"],t&&(t.minDate!==f&&"today"===t.minDate&&(t.minDate=new Date,t.timeZone!==f)&&""!==t.timeZone&&(t.minDate=new Date(t.minDate.toLocaleString("en-US",{timeZone:t.timeZone}))),e=Object.assign(e,t)),new AirDatepicker(a.getPath(),e),a.attr("readonly",!0)})},events:function(){var e=this;u(m).on("merchant-flexible-content-added",function(){e.initiate_datepicker()})}}).init();({init:function(e){this.events()},events:function(){var a=this;u(".merchant-sortable").each(function(){var e=u(this),t=e.find(".merchant-sortable-input");u(e.find("ul.merchant-sortable-list").first()).sortable({update:function(){t.val(a.sortableGetNewVal(e)).trigger("change.merchant")}}).disableSelection().find("li").each(function(){u(this).find("i.visibility").click(function(){u(this).toggleClass("dashicons-visibility-faint").parents("li:eq(0)").toggleClass("invisible")})}).click(function(){u(event.target).hasClass("dashicons-visibility")&&t.val(a.sortableGetNewVal(e)).trigger("change.merchant")})})},sortableGetNewVal:function(e){var e=u(e.find("li")),t=[];return _.each(e,function(e){u(e).hasClass("invisible")||t.push(u(e).data("value"))}),JSON.stringify(t)}}).init(),e.init(),u(m).on("merchant-flexible-content-added",function(e,t){t=t.find(".merchant-sortable-repeater-control").find(".merchant-sortable-repeater.sortable");c.makeFieldsSortable(t)});var r,c={init:function(e){var n=this;u(".merchant-sortable-repeater-control").each(function(){var e=JSON.parse(u(this).find(".merchant-sortable-repeater-input").val()),t=e.length;if(0<t&&(u(this).find(".repeater-input").val(e[0]),1<t))for(var a=1;a<t;++a)n.appendRow(u(this),e[a])}),this.events()},events:function(){var t=this;u(m).on("click",".merchant-sortable-repeater.sortable .customize-control-sortable-repeater-delete",function(e){e.preventDefault(),u(this).parent().slideUp("fast",function(){var e=u(this).parent().parent();u(this).remove(),t.getAllInputs(e)}),u(m).trigger("merchant-sortable-repeater-item-deleted")}),u(m).on("click",".customize-control-sortable-repeater-add",function(e){e.preventDefault(),t.appendRow(u(this).parent()),t.getAllInputs(u(this).parent())}),u(m).on("change",".merchant-sortable-repeater.sortable",function(){t.getAllInputs(u(this).parent())}),u(m).on("focusout",".merchant-sortable-repeater.sortable .repeater-input",function(){t.getAllInputs(u(this).parent())})},appendRow:function(e){var t='<div class="repeater" style="display:none"><input type="text" value="'+(1<arguments.length&&arguments[1]!==f?arguments[1]:"")+'" class="repeater-input" /><span class="dashicons dashicons-menu"></span><a class="customize-control-sortable-repeater-delete" href="#"><span class="dashicons dashicons-no-alt"></span></a></div>',t=(e.find(".sortable").append(t),e.find(".sortable").find(".repeater:last"));t.slideDown("slow",function(){u(this).find("input").focus()}),this.makeFieldsSortable(e.find(".sortable")),u(m).trigger("merchant-sortable-repeater-item-added",[t,e.find(".sortable")])},makeFieldsSortable:function(a){a.hasClass("disable-sorting")||a.sortable({update:function(e,t){c.getAllInputs(a.parent())}})},getAllInputs:function(e){var t=e.find(".repeater-input").map(function(){return u(this).val()}).toArray();t.length||t.push(""),e.find(".merchant-sortable-repeater-input").val(JSON.stringify(t)),e.find(".merchant-sortable-repeater-input").trigger("change"),e.find(".merchant-sortable-repeater-input").trigger("sortable.repeater.change")}},o=(c.init(),{init:function(){this.initAccordion(),this.initFlag()},initAccordion:function(){u(".merchant-group-field.has-accordion").each(function(){var e=u(this);e.accordion({collapsible:!0,header:"> .title-area",heightStyle:"content",active:!!e.hasClass("open")&&0})})},initFlag:function(){u(".merchant-group-field.has-flag").each(function(){var e=u(this),t=e.data("id"),t=e.find(".merchant-field-".concat(t,"_status select")),a=t.val(),t=t.find("option:selected").text();e.find(".field-status").removeClass("hidden active inactive").text(t).addClass(a)})}});({init:function(e){var n=this;u(".merchant-flexible-content-control").each(function(){var e=u(this).hasClass("has-accordion"),a=u(this).find(".merchant-flexible-content");e?a.accordion({collapsible:!0,header:function(e){return e.find(".layout__inner > .layout-header")},heightStyle:"content"}).sortable({axis:"y",cursor:"move",helper:"original",handle:".customize-control-flexible-content-move",stop:function(e,t){a.trigger("merchant.sorted"),n.refreshNumbers(a),a.accordion("refresh")}}):a.sortable({axis:"y",cursor:"move",helper:"original",handle:".customize-control-flexible-content-move",stop:function(e,t){a.trigger("merchant.sorted"),n.refreshNumbers(a),a.accordion("refresh")}})}),this.updateLayoutTitle(),this.updateDiscountPercentMaxVal(),this.events()},updateLayoutTitle:function(){u(".merchant-flexible-content .layout").each(function(){var e,t=u(this).find(".layout-title[data-title-field]");t.length&&((e=u(this).find(".layout-body .merchant-field-"+t.data("title-field")+" input")).on("change keyup",function(){t.text(u(this).val())}),t.text(e.val()))})},updateDiscountPercentMaxVal:function(){u(".merchant-flexible-content .layout").each(function(){var e=u(this),t=e.find('.merchant-module-page-setting-field[data-id="discount_type"]'),a=e.find('.merchant-module-page-setting-field[data-id="discount_value"]'),e=(a=(a=a.length?a:e.find('.merchant-module-page-setting-field[data-id="discount"]')).length?a:e.find('.merchant-module-page-setting-field[data-id="discount_amount"]'),t.find("input:checked").val());"percentage_discount"===e||"percentage"===e?a.find("input").attr("max",100):a.find("input").removeAttr("max")}),u(".merchant-module-page-setting-fields")},events:function(){var r=this;function a(e){e&&e.length&&e.siblings().find(".layout-actions__inner").slideUp(300)}u(m).on("change",'.merchant-module-page-setting-field[data-id="discount_type"] input',function(){r.updateDiscountPercentMaxVal()}),u(m).on("change","select",function(){var t=u(this).val(),a=u(this).prop("multiple");u(this).find("option").each(function(){var e=u(this).val(),e=a?t.includes(e):e===t;u(this).attr("selected",e)})}),u(".customize-control-flexible-content-add-button").click(function(e){e.preventDefault(),e.stopImmediatePropagation(),1===u(this).parent().find(".customize-control-flexible-content-add-list a").length?u(this).parent().find(".customize-control-flexible-content-add-list a").trigger("click"):u(this).parent().find(".customize-control-flexible-content-add-list").toggleClass("active")}),u(m).on("click",".customize-control-flexible-content-add",function(e){e.preventDefault(),e.stopImmediatePropagation();var e=u(".merchant-flexible-content-control[data-id="+u(this).data("id")+"]"),t=e.find(".layouts"),a=u(this).data("layout"),t=t.find(".layout[data-type="+a+"]").clone(!0),a=e.find(".merchant-flexible-content"),n=a.find(".layout"),e=(t.find("input, select, textarea").each(function(){u(this).data("name")&&u(this).attr("name",u(this).data("name").replace("0",n.length)),u(this).is(":checkbox, :radio")&&u(this).attr("checked")&&u(this).prop("checked",!0)}),t.find(".layout-count").text(n.length+1),a.append(t),a.removeClass("empty"),u(this).parent().removeClass("active"),t.find(".merchant-module-page-setting-field-upload").length&&s(t.find(".merchant-module-page-setting-field-upload")),t.find(".merchant-module-page-setting-field-select_ajax").length&&l(t.find(".merchant-module-page-setting-field-select_ajax")),u(this).closest(".merchant-flexible-content-control"));e.hasClass("has-accordion")&&(e.find(".merchant-flexible-content").accordion("refresh"),e.find(".merchant-flexible-content").accordion("option","active",-1)),o.init(),u(m).trigger("merchant-flexible-content-added",[t]),r.updateLayoutTitle(),r.updateDiscountPercentMaxVal()}),u(m).on("click",".customize-control-flexible-content-duplicate",function(e){e.preventDefault(),e.stopImmediatePropagation();var t,n,e=u(this),a=e.closest(".merchant-flexible-content-control[data-id="+e.data("id")+"]"),i=null==a?void 0:a.find(".merchant-flexible-content");a.length&&i.length&&(e=e.closest(".layout")).length&&(e.find(".layout-actions__inner").hide(),t=e.clone(),i.find(".layout"),n=e.find(".layout-count").text(),t.find("input, select, textarea").each(function(){var e,t=u(this),a=t.attr("name");a&&(e=a.split("[")[0],a=a.match(/\[(.*?)\]/g))&&1<a.length&&(a[1]="["+n+"]",e="".concat(e).concat(a.join("")),t.attr("name",e))}),t.find("select").each(function(){u(this).hasClass("select2-hidden-accessible")&&(u(this).removeClass("select2-hidden-accessible").removeAttr("data-live-search").removeAttr("data-select2-id").removeAttr("aria-hidden").removeAttr("tabindex"),u(this).nextAll(".select2-container").remove(),u(this).select2())}),t.find(".layout-body").removeAttr("style"),t.hide(),t.insertAfter(e),t.fadeIn(),t.find(".merchant-module-page-setting-field-upload").length&&s(t.find(".merchant-module-page-setting-field-upload")),t.find(".merchant-module-page-setting-field-select_ajax").length&&l(t.find(".merchant-module-page-setting-field-select_ajax")),r.refreshNumbers(i),u(m).trigger("merchant-flexible-content-added",[t]),a.hasClass("has-accordion")&&i.accordion("refresh"),r.updateLayoutTitle(),o.init())}),u(m).on("click",".customize-control-flexible-content-delete",function(e){e.preventDefault();var e=u(this).closest(".layout"),t=e.parent(),t=(e.remove(),0===t.find(".layout").length&&t.addClass("empty"),r.refreshNumbers(t),u(m).trigger("merchant-flexible-content-deleted",[e]),u(this).closest(".merchant-flexible-content-control"));t.hasClass("has-accordion")&&t.find(".merchant-flexible-content").accordion("refresh"),u(m).trigger("change.merchant")}),u(m).on("click",".layout-actions__toggle",function(e){e.preventDefault(),a(u(this).closest(".layout")),u(this).closest(".layout-actions").find(".layout-actions__inner").stop().slideToggle(300)}),u(m).on("click",".layout-header",function(){a(u(this).closest(".layout"))}),u(m).on("merchant-flexible-content-added",function(e,t){a(t)})},refreshNumbers:function(e){e.find(".layout").each(function(e){var t=u(this).find(".layout-count").text(),a=parseInt(t)-1;u(this).find(".layout-count").text(e+1),u(this).find("input, select, textarea").each(function(){u(this).attr("name")&&u(this).attr("name",u(this).attr("name").replace("["+a+"]","[*refreshed*"+e+"]"))})}),e.find(".layout").each(function(e){u(this).find("input, select, textarea").each(function(){var e=u(this).attr("name");e&&u(this).attr("name",e.replace("*refreshed*",""))})}),e.parent().find("input").trigger("change.merchant")}}).init(),o.init(),u(m).on("keyup",".merchant-module-page-setting-field-products_selector .merchant-search-field",function(){clearTimeout(r);var e,t,a,n=[],i=(!u(this).closest('[data-id="excluded_products"]').length||"categories"!==(t=(e=u(this).closest(".layout")).find(".merchant-field-rules_to_apply select").val()||e.find(".merchant-field-rules_to_display select").val()||e.find(".merchant-field-display_rules select").val())&&"by_category"!==t||(n=e.find(".merchant-field-category_slugs select").val()||e.find(".merchant-field-product_cats select").val()),u(this).closest(".merchant-products-search-container"));""!==u(this).val()?(i.find(".merchant-searching").addClass("active"),a={action:"merchant_admin_products_search",nonce:merchant_admin_options.ajaxnonce,keyword:u(this).val(),product_types:u(this).data("allowed-types"),ids:i.find(".merchant-selected-products").val(),categories:n},r=setTimeout(function(){u.post(merchant_admin_options.ajaxurl,a,function(e){var t=i.find(".merchant-selections-products-preview");t.show(),t.html(e),i.find(".merchant-searching").removeClass("active")})},250)):i.find(".merchant-selections-products-preview").html("").hide()}),u(m).on("click touch",".merchant-module-page-setting-field-products_selector .merchant-selections-products-preview li",function(){var e=u(this).closest(".merchant-products-search-container"),t=e.find(".merchant-selected-products"),a=t.val(),n="multiple"===e.data("multiple");0<e.find(".merchant-selected-products-preview ul li").length&&!n&&(e.find(".merchant-selected-products-preview ul li").remove(),t.val("").change()),u(this).children(".remove").attr("aria-label","Remove").html("Ã—"),e.find(".merchant-selected-products-preview ul").append(u(this)),e.find(".merchant-selections-products-preview").html("").hide(),e.find(".merchant-search-field").val("").change(),""===a?t.val(u(this).data("id")):(n?((e=a.split(",")).push(u(this).data("id")),t.val(e.join(","))):t.val(u(this).data("id"))).change()}),u(m).on("click touch",".merchant-selected-products-preview .remove",function(){var e=u(this);if(confirm(merchant_admin_options.product_delete_confirmation_message)){var t=e.closest(".merchant-products-search-container").find(".merchant-selected-products"),a=e.parent().data("id"),n=(e.parent().remove(),t.val().split(","));if(0<n.length)for(var i in n)parseInt(n[i])===parseInt(a)&&n.splice(i,1);t.val(n.join(",")).change(),t.trigger("change.merchant")}}),u(m).on("merchant-admin-check-fields merchant-flexible-content-added",function(){u(".merchant-module-page-setting-field").each(function(){var e=u(this);if(e.data("condition")&&e.data("condition").length){var t=e.data("condition"),a=u(this).closest(".layout-body").find('input[name*="'+t[0]+'"],select[name*="'+t[0]+'"]');if((a=a.length?a:u('input[name="merchant['+t[0]+']"],select[name="merchant['+t[0]+']"]')).length){var n,i=!1;switch(t[1]){case"==":"radio"!==a.attr("type")&&"checkbox"!==a.attr("type")||(n=a.parent().find("input:checked")).length&&n.val()===t[2]&&(i=!0),a.is("select")&&a.val()==t[2]&&(i=!0);break;case"any":"radio"!==a.attr("type")&&"checkbox"!==a.attr("type")||(n=a.parent().find("input:checked")).length&&t[2].split("|").includes(n.val())&&(i=!0),a.is("select")&&t[2].split("|").includes(a.val())&&(i=!0)}i?e.removeClass("merchant-hide").addClass("merchant-show"):e.removeClass("merchant-show").addClass("merchant-hide")}}})}).trigger("merchant.change"),u(m).on("merchant-admin-check-fields merchant-flexible-content-added change keyup",function(){u(m).find(".merchant-module-page-setting-field").each(function(){var e=u(this);e.data("conditions")&&(function e(t){var a=1<arguments.length&&arguments[1]!==f&&arguments[1];var n=!1;if("relation"in t){var i=t.relation.toUpperCase();if("OR"===i)for(var r=0;r<t.terms.length;r++){var c=t.terms[r];if(n=e(c,a))return!0}else if("AND"===i){for(var o=0,s=0;s<t.terms.length;s++){var l=t.terms[s];e(l,a)&&o++}o===t.terms.length&&(n=!0)}}else{var d,i="",h=(i="terms"in t?t.terms[0]:t,u('input[name="merchant['+i.field+']"],select[name="merchant['+i.field+']"]')),m=(h.length||0<(d=a.closest(".layout-body")).length&&(h=d.find(".merchant-field-"+i.field).find("input, select")),(h=(h=h.length?h:u('input[name="merchant['+i.field+'][]"],select[name="merchant['+i.field+'][]"]')).length?h:u(".merchant-group-fields-container").find(".merchant-field-"+i.field+' input[name*="'+i.field+'"],.merchant-field-'+i.field+' select[name*="'+i.field+'"]')).val());"checkbox"===h.attr("type")&&(m=h.is(":checked")),"radio"===h.attr("type")&&(m=h.filter(":checked").val()),"checkbox"===h.attr("type")&&1<h.length&&(m=[],h.each(function(){u(this).is(":checked")&&m.push(u(this).val())})),v(m)&&(m=Number(m)),Array.isArray(i.value)&&(i.value=i.value.map(function(e){return v(e)?Number(e):e})),("==="===i.operator&&m===i.value||"!=="===i.operator&&m!==i.value||">"===i.operator&&m>i.value||"<"===i.operator&&m<i.value||">="===i.operator&&m>=i.value||"<="===i.operator&&m<=i.value||"in"===i.operator&&i.value.includes(m)||"!in"===i.operator&&!i.value.includes(m)||"contains"===i.operator&&Array.isArray(m)&&m.includes(i.value)||"!contains"===i.operator&&Array.isArray(m)&&!m.includes(i.value))&&(n=!0)}return n}(e.data("conditions"),e)?e.removeClass("merchant-hide").addClass("merchant-show"):e.removeClass("merchant-show").addClass("merchant-hide"))})}).trigger("merchant.change"),u(m).on("change",".merchant-module-page-setting-field",function(){u(m).trigger("merchant-admin-check-fields")}).trigger("merchant.change"),u(m).trigger("merchant-admin-check-fields"),u(m).on("merchant-admin-check-color-fields merchant-flexible-content-added",function(){u(".merchant-color").each(function(){var a,e=u(this),n=e.find(".merchant-color-picker"),i=e.find(".merchant-color-input"),r=!1;n.off("click").on("click",function(e){e.preventDefault(),e.stopPropagation();var t=u("body,html");t.addClass("merchant-height-auto"),r?a.setColor(i.val()):((a=new Pickr({el:n.get(0),container:"body",theme:"merchant",appClass:"merchant-pcr-app",default:i.val()||n.data("default-color")||"#212121",swatches:["#000000","#F44336","#E91E63","#673AB7","#03A9F4","#8BC34A","#FFEB3B","#FFC107","#FFFFFF"],sliders:"h",useAsButton:!0,components:{hue:!0,preview:!0,opacity:!0,interaction:{input:!0,clear:!0}},i18n:{"btn:clear":"Default"}})).on("change",function(e){e=(1===e.a?(a.setColorRepresentation("HEX"),e.toHEXA()):(a.setColorRepresentation("RGBA"),e.toRGBA())).toString(0);n.css({"background-color":e}),i.val()!==e&&i.val(e).trigger("change.merchant"),u(m).trigger("merchant-color-picker-updated",[e,i])}),a.on("clear",function(){var e=n.data("default-color");e?a.setColor(e):(n.css({"background-color":"white"}),i.val(""))}),a.on("hide",function(){t.removeClass("merchant-height-auto")}),n.data("pickr",a),setTimeout(function(){a.show()},200),r=!0)}),i.on("change keyup",function(){var e=u(this).val();n.css({"background-color":e})})})}),u(m).trigger("merchant-admin-check-color-fields");({init:function(){this.events()},events:function(){var l=this;u(m).on("click",".merchant-create-page-control-button",function(e){e.preventDefault();var t=u(this),a=t.parent().find(".merchant-create-page-control-create-message"),n=t.parent().find(".merchant-create-page-control-success-message"),e=(t.text(),t.data("creating-text")),i=(t.data("created-text"),t.data("page-title")),r=t.data("page-meta-key"),c=t.data("page-meta-value"),o=t.data("option-name"),s=t.data("nonce");if(!i)return!1;u(this).text(e),u(this).attr("disabled",!0),u.ajax({type:"post",url:ajaxurl,data:{action:"merchant_create_page_control",page_title:i,page_meta_key:r,page_meta_value:c,option_name:o,nonce:s},success:function(e){l.ajaxResponseHandler(e,t,n,a)}})})},ajaxResponseHandler:function(e,t,a,n){"success"===e.status&&(e=a.find("a").attr("href").replace("?post=&","?post="+e.page_id+"&"),a.find("a").attr("href",e),a.css("display","block"),n.remove(),t.remove())}}).init(),u(".merchant-module-page-setting-field-gallery").each(function(){var n,i=u(this),e=i.find(".merchant-gallery-button"),r=i.find(".merchant-gallery-input"),c=i.find(".merchant-gallery-images"),t=i.find(".merchant-gallery-remove");c.sortable({helper:"original",update:function(e,t){var a=[];c.find(".merchant-gallery-image").each(function(){a.push(u(this).data("item-id"))}),r.val(a.join(",")).trigger("change")}});t.on("click",function(e){e.preventDefault(),u(this).parent().remove();var t=[];c.find(".merchant-gallery-image").each(function(){t.push(u(this).data("item-id"))}),r.val(t.join(",")).trigger("change")}),e.on("click",function(e){u(this);var t=r.val(),a=t?"edit":"add";e.preventDefault(),void 0!==h.wp&&h.wp.media&&h.wp.media.gallery&&("add"==a?(n=h.wp.media({library:{type:"image"},frame:"post",state:"gallery",multiple:!0})).open():n=h.wp.media.gallery.edit('[gallery ids="'+t+'"]'),n.on("update",function(e){c.empty();e=e.models.map(function(e){var e=e.toJSON(),t=(e.sizes&&e.sizes.thumbnail&&e.sizes.thumbnail.url?e.sizes.thumbnail:e).url;return c.append('<div class="merchant-gallery-image" data-item-id="'+e.id+'"><i class="merchant-gallery-remove dashicons dashicons-no-alt"></i><img src="'+t+'" /></div>'),e.id});r.val(e.join(",")).trigger("change"),i.find(".merchant-gallery-remove").on("click",function(e){e.preventDefault(),u(this).parent().remove();var t=[];c.find(".merchant-gallery-image").each(function(){t.push(u(this).data("item-id"))}),r.val(t.join(",")).trigger("change")})}))})});var s=function(e){var a,n=e,e=n.find(".merchant-upload-button"),i=n.find(".merchant-upload-input"),r=n.find(".merchant-upload-wrapper");n.find(".merchant-upload-remove").on("click",function(e){e.preventDefault(),u(this).parent().remove(),i.val("").trigger("change")}),e.on("click",function(e){e.preventDefault(),void 0!==h.wp&&h.wp.media&&((a=a||h.wp.media({library:{type:"image"}})).open(),a.on("select",function(){r.empty();var e=a.state().get("selection").first().attributes,t=(e.sizes&&e.sizes.thumbnail&&e.sizes.thumbnail.url?e.sizes.thumbnail:e).url;r.append('<div class="merchant-upload-image"><i class="merchant-upload-remove dashicons dashicons-no-alt"></i><img src="'+t+'" /></div>'),i.val(e.id).trigger("change"),n.find(".merchant-upload-button-drag-drop").hide(),n.find(".merchant-upload-remove").on("click",function(e){e.preventDefault(),u(this).parent().remove(),i.val("").trigger("change"),n.find(".merchant-upload-button-drag-drop").show()})}))})},l=(u(".merchant-module-page-setting-field-upload:not(.template)").each(function(){s(u(this))}),jQuery.each(["dragenter","dragover","dragleave","drop"],function(e,t){u(m).on(t,".merchant-upload-button-drag-drop",function(e){e.preventDefault(),e.stopPropagation()})}),u(m).on("dragenter",".merchant-upload-button-drag-drop",function(e){u(this).closest(".merchant-module-page-setting-field-upload").find(".merchant-upload-button").click()}),function(e){var t=e.find("select"),a=t.data("source"),n=h.merchant_admin_options,i={width:"100%",templateSelection:function(e){return e.text.replace(/&nbsp;-*\s*/g,"").trim()}};"post"!==a&&"product"!==a&&"user"!==a||(i.minimumInputLength=1,i.ajax={url:n.ajaxurl,dataType:"json",delay:250,cache:!0,data:function(e){return{action:"merchant_admin_options_select_ajax",nonce:n.ajaxnonce,term:e.term,source:a}},processResults:function(e,t){return e.success?{results:e.data}:{}}}),t.select2(i),e.find(".select2-selection--multiple").append('<span class="merchant-select2-clear"></span>')}),d=(u(".merchant-module-page-setting-field-select_ajax:not(.template)").each(function(){l(u(this))}),u(".merchant-module-page-settings-responsive").each(function(){var e=u(this),a=e.find(".merchant-module-page-settings-devices button"),n=e.find(".merchant-module-page-settings-device-container");a.on("click",function(e){e.preventDefault();var t=u(this).data("device");a.removeClass("active"),n.removeClass("active"),u(this).addClass("active"),n.each(function(){u(this).data("device")===t&&u(this).addClass("active")})})}),u(".merchant-animated-buttons").each(function(){var e,t,a=u(this).find("label"),n=u(".merchant-animation-demo");a.on("click",function(){n.removeClass("merchant-animation-"+e),n.removeClass("merchant-animation-"+t),e=u(this).find("input").attr("value"),setTimeout(function(){n.addClass("merchant-animation-"+e)},100),setTimeout(function(){n.removeClass("merchant-animation-"+e)},1e3)}),a.mouseover(function(){n.removeClass("merchant-animation-"+e),t=u(this).find("input").attr("value"),n.addClass("merchant-animation-"+t)}).mouseout(function(){n.removeClass("merchant-animation-"+t)})}),u(".merchant-notifications-sidebar")),e=(d.length&&(u(".merchant-notifications").on("click",function(e){e.preventDefault();var t=u(this),e=d.find(".merchant-notification:first-child .merchant-notification-date").data("raw-date");d.toggleClass("opened"),t.hasClass("read")||u.post(h.merchant.ajax_url,{action:"merchant_notifications_read",nonce:h.merchant.nonce,latest_notification_date:e},function(e){e.success&&setTimeout(function(){t.addClass("read")},2e3)})}),u(h).on("scroll",function(){60<h.pageYOffset&&(d.addClass("closing"),setTimeout(function(){d.removeClass("opened"),d.removeClass("closing")},300))}),u(".merchant-notifications-sidebar-close").on("click",function(e){e.preventDefault(),d.addClass("closing"),setTimeout(function(){d.removeClass("opened"),d.removeClass("closing")},300)})),u(".merchant-tabs-nav")),t=(e.length&&e.each(function(){var a=u(this).data("tab-wrapper-id");u(this).find(".merchant-tabs-nav-link").on("click",function(e){e.preventDefault();var e=u(this).closest(".merchant-tabs-nav").find(".merchant-tabs-nav-link"),t=u(this).data("tab-to"),e=(e.each(function(){u(this).closest(".merchant-tabs-nav-item").removeClass("active")}),u(this).closest(".merchant-tabs-nav-item").addClass("active"),u('.merchant-tab-content-wrapper[data-tab-wrapper-id="'+a+'"]'));e.find("> .merchant-tab-content").removeClass("active"),e.find('> .merchant-tab-content[data-tab-content-id="'+t+'"]').addClass("active")})}),u(".merchant-module-alert"));t.length&&t.find(".merchant-module-alert-close").on("click",function(e){e.preventDefault(),t.removeClass("merchant-show"),u(m).off("click.merchant-alert-close")})})}(jQuery,window,document),jQuery.fn.extend({getPath:function(){var o=[];return this.each(function(e,t){for(var a,n=jQuery(t);n.length;){var i=n.get(0);if(!(r=i.localName))break;var r=r.toLowerCase(),c=n.parent();1<c.children(r).length&&0<(e=c.children().index(i)+1)&&(r+=":nth-child("+e+")"),a=r+(a?" > "+a:""),n=c}o.push(a)}),o.join(",")}});