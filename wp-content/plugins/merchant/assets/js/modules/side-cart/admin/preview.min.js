"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var l=0;l<t.length;l++){var r=t[l];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,l){return t&&_defineProperties(e.prototype,t),l&&_defineProperties(e,l),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var l=e[Symbol.toPrimitive];if(void 0===l)return("string"===t?String:Number)(e);l=l.call(e,t||"default");if("object"!==_typeof(l))return l;throw new TypeError("@@toPrimitive must return a primitive value.")}!function(s){var e=function(){function e(){_classCallCheck(this,e),this.init()}return _createClass(e,[{key:"init",value:function(){this.events(),this.flexibleContentLabel()}},{key:"events",value:function(){s(document).on("change keyup merchant.change",".merchant-module-page-setting-fields",this.flexibleContentLabel.bind(this))}},{key:"flexibleContentLabel",value:function(){var n=this;this.cartUpsellsToggleState()&&"custom_upsell"===this.cartUpsellType()&&s(".merchant-field-custom_upsells .merchant-flexible-content .layout").each(function(){var e=s(this),t=n.customUpsellTrigger(e),l=n.customUpsellCategories(e),r=n.customUpsellProducts(e);"categories"===t&&n.updateGroupLabel(e,"categories",l.length,l),"products"===t&&n.updateGroupLabel(e,"products",r.length,r),"all"===t&&n.updateGroupLabel(e,"all",10,[])})}},{key:"upsellsLabelBadge",value:function(e){if("products"===e.find(".merchant-field-custom_upsell_type select").val()){e=e.find(".merchant-field-upsells_product_ids .merchant-selected-products-preview li");if(e.length)return'<span class="merchant-upsells-badge">Upsells: '.concat(e.length,"</span>")}return""}},{key:"updateGroupLabel",value:function(e,t,l,r){var n=e.find(".layout-title");"categories"===t&&(1<l?n.html(merchant_side_cart_params.keywords.multi_categories+this.upsellsLabelBadge(e)):1===l?n.html(merchant_side_cart_params.keywords.category_trigger+" "+r[0]+this.upsellsLabelBadge(e)):n.html(merchant_side_cart_params.keywords.no_cats_selected+this.upsellsLabelBadge(e))),"products"===t&&(1<l?n.html(merchant_side_cart_params.keywords.multi_products+this.upsellsLabelBadge(e)):1===l?n.html(r[0].name+" (#"+r[0].id+")"+this.upsellsLabelBadge(e)):n.html(merchant_side_cart_params.keywords.no_products_selected+this.upsellsLabelBadge(e))),"all"===t&&n.html(merchant_side_cart_params.keywords.all_products+this.upsellsLabelBadge(e))}},{key:"customUpsellTrigger",value:function(e){return e.find(".merchant-field-upsell_based_on select").val()}},{key:"customUpsellProducts",value:function(e){var e=e.find(".merchant-field-product_ids .merchant-selected-products-preview li"),t=[];return e.each(function(){t.push({id:s(this).data("id"),name:s(this).data("name"),element:s(this)})}),t}},{key:"customUpsellCategories",value:function(e){return e.find(".merchant-field-category_slugs select").find("option:selected").map(function(){return s(this).text().trim()}).get()}},{key:"cartUpsellsToggleState",value:function(){return!!s(".merchant-field-use_upsells input").is(":checked")}},{key:"cartUpsellType",value:function(){return s(".merchant-field-upsells_type select").val()}}]),e}();s(document).ready(function(){new e})}(jQuery);