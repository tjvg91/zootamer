"use strict";jQuery(document).ready(function(c){function t(){var t=null==(t=merchant_side_cart_params)?void 0:t.allowed_devices,a=window.innerWidth;return a<=768&&t.includes("mobile")||!!(768<a&&t.includes("desktop"))}var a,e,n,i,s;merchant.setting.hasOwnProperty("show_after_add_to_cart_single_product")&&t()&&(a=c("body.single-product").length,e=c(".woocommerce-notices-wrapper").is(":visible")&&!c(".woocommerce-notices-wrapper").is(":empty"),n=c(".wc-block-components-notice-banner").is(":visible")&&!c(".wc-block-components-notice-banner").is(":empty"),a)&&(e||n)&&(c("body").toggleClass("merchant-floating-side-mini-cart-show"),c(window).trigger("merchant.floating-mini-cart-resize")),merchant.setting.hasOwnProperty("add_to_cart_slide_out")&&t()&&c(document.body).on("added_to_cart",function(t,a,e,n,r){"side-cart"!==r&&c("body").toggleClass("merchant-floating-side-mini-cart-show"),c(window).trigger("merchant.floating-mini-cart-resize")}),merchant.setting.hasOwnProperty("cart_url")&&t()&&c('[href="'+merchant.setting.cart_url+'"]').on("click",function(t){t.preventDefault(),c(window).trigger("merchant.floating-mini-cart-resize"),c("body").toggleClass("merchant-floating-side-mini-cart-show")}),(merchant.setting.hasOwnProperty("add_to_cart_slide_out")||merchant.setting.hasOwnProperty("floating_mini_cart_count"))&&t()&&(i=function(a){var t,e,n,r=merchant.setting||{},o=r.ajax_url,i=r.side_cart_nonce;a.length&&o&&i&&(t=a.attr("name"),e=Math.round(parseFloat(a.val()||1)),n=a.closest(".js-side-cart-item"),clearTimeout(s),s=setTimeout(function(){c.ajax({type:"POST",url:o,data:{action:"update_side_cart_quantity",cart_item_key:t,quantity:e,nonce:i},beforeSend:function(){n.length&&n.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},success:function(t){t&&t.fragments&&(c(document.body).trigger("added_to_cart",[t.fragments,t.cart_hash,a,"side-cart"]),n.length)&&(n.unblock(),c(document).trigger("merchant_destroy_carousel"),c(document).trigger("merchant_init_carousel"))},error:function(t){console.log("Error:",t)}})},350))},c(document).on("click",".js-merchant-quantity-btn",function(t){t.preventDefault();var a,e,n,r,t=c(this),o=t.closest(".merchant-quantity-wrap").find(".js-update-quantity");o.length&&(a=+(o.val()||1),e=+o.attr("min"),n=+o.attr("max"),r=Math.round(parseFloat(o.attr("step"))),t.hasClass("merchant-quantity-plus")?(a+=r,a=n&&-1!=n?Math.min(a,n):a):t.hasClass("merchant-quantity-minus")&&(a-=r,a=e?Math.max(a,e):a),o.val(a),i(o))}),c(document).on("input change",".js-update-quantity",function(t){t.preventDefault(),i(c(this))})),{init:function(){var t=this;this.bindEvents(),setTimeout(function(){c(document).trigger("merchant_init_carousel"),c(document).find(".woocommerce-mini-cart-item.merchant-upsell-widget").on("mouseenter",function(){c(document).find(".merchant-mini-cart-upsells.upsells-layout-carousel").hasClass("slick-initialized")&&c(".merchant-mini-cart-upsells.upsells-layout-carousel").slick("slickPause")}),c(document).find(".woocommerce-mini-cart-item.merchant-upsell-widget").on("mouseleave",function(){c(document).find(".merchant-mini-cart-upsells.upsells-layout-carousel").hasClass("slick-initialized")&&c(".merchant-mini-cart-upsells.upsells-layout-carousel").slick("slickPlay")}),t.sideCartBtns()},500)},bindEvents:function(){c(document).on("change",".merchant-mini-cart-upsell-item-wrap .variation-selector",this.handleVariationChange.bind(this)),c(document).on("click",".add-to-cart-wrap .merchant-upsell-add-to-cart:not(.disabled)",this.handleAddToCartClick.bind(this)),c(document).on("click",".merchant-coupon-form button",this.handleCouponBtnClick.bind(this)),c(document).on("click",".merchant-remove-coupon",this.handleCouponRemoveClick.bind(this)),c(document).on("merchant_init_carousel",this.initCarousel.bind(this)),c(document).on("merchant_destroy_carousel",this.destroyCarousel.bind(this)),c(document).on("added_to_cart",this.handleAddToCart.bind(this)),c(document).on("removed_from_cart",this.handleRemoveFromCart.bind(this))},handleVariationChange:function(t){var a=c(t.target).closest(".merchant-mini-cart-upsell-item-wrap"),e=a.attr("data-variations")&&JSON.parse(a.attr("data-variations"))||[],n=a.find(".variation-selector"),r=(a.attr("data-variation-id",0),{name:c(t.target).attr("data-attribute_name"),value:c(t.target).val()}),o=[],i=e.filter(function(t){return void 0!==t.attributes[r.name.toLowerCase()]&&t.attributes[r.name.toLowerCase()]===r.value});n.each(function(){var t=c(this),a=t.attr("data-attribute_name");i.forEach(function(t){t=t.attributes[a.toLowerCase()];void 0===t||""===t||o.includes(t)||o.push(t)}),r.name.toLowerCase()!==a.toLowerCase()&&t.find("option").each(function(){var t=c(this).attr("value");""!==t&&(o.includes(t)?c(this).show():c(this).hide())})}),this.isAllVariationsSelected(a)?(this.fetchVariationDetails(a,a.attr("data-product-id"),this.getSelectedAttributes(a),this),this.handleAddToCartBtnState(a,!0)):this.handleAddToCartBtnState(a,!1)},fetchVariationDetails:function(a,t,e,n){var r;c.ajax({type:"POST",url:null==(r=merchant_side_cart_params)?void 0:r.ajax_url,data:{action:"merchant_get_variation_data",product_id:t,nonce:null==(r=merchant_side_cart_params)?void 0:r.variation_info_nonce,attributes:e},success:function(t){t.success&&(console.log(t.data),a.attr("data-variation-id",t.data.id),n.updateProductThumbnail(a,t.data.thumbnail_url))},error:function(t){console.log("Error:",t)}})},updateProductThumbnail:function(t,a){t.find(".product-thumbnail a img").attr("src",a)},getSelectedAttributes:function(t){var a={};return t.find(".variation-selector").each(function(){a[c(this).attr("name")]=c(this).val()}),a},handleAddToCartBtnState:function(t,a){t=t.find(".add-to-cart-wrap .merchant-upsell-add-to-cart");a?(t.removeClass("disabled"),t.prop("disabled",!1)):(t.addClass("disabled"),t.prop("disabled",!0))},isAllVariationsSelected:function(t){t=t.find(".variation-selector");return t.length&&t.toArray().every(function(t){return""!==c(t).val()})},handleAddToCartClick:function(t){t.preventDefault();var t=c(t.currentTarget),a=t.closest(".merchant-mini-cart-upsell-item-wrap"),e=a.attr("data-product-type"),n=a.attr("data-product-id"),a=a.attr("data-variation-id");"variable"===e&&"0"!==a?this.addToCart(this,"variable",n,a,t):"simple"===e?this.addToCart(this,"simple",n,a,t):console.log("Unsupported product type:",e)},addToCart:function(a,t,e,n,r){n={action:"merchant_side_cart_upsells_add_to_cart",product_id:e,variation_id:n,nonce:null==(e=merchant_side_cart_params)?void 0:e.nonce};c.ajax({type:"POST",url:null==(e=merchant_side_cart_params)?void 0:e.ajax_url,data:n,beforeSend:function(){r.addClass("loading")},success:function(t){a.handleSuccess(t)},error:function(t){a.handleError(t)},complete:function(){r.removeClass("loading")}})},handleSuccess:function(t){t.data.fragments&&(c(document).trigger("merchant_destroy_carousel"),c(document.body).trigger("added_to_cart",[t.data.fragments,t.data.cart_hash,null,"side-cart"]),c(document).trigger("merchant_init_carousel"))},handleError:function(t){console.log("Error:",t)},handleAddToCart:function(t,a,e,n,r){c(document).trigger("merchant_destroy_carousel"),c(document).trigger("merchant_init_carousel")},handleRemoveFromCart:function(t){c(document).trigger("merchant_destroy_carousel"),c(document).trigger("merchant_init_carousel")},initCarousel:function(){var t,a=c(document).find(".merchant-mini-cart-upsells.upsells-layout-carousel");"carousel"!==(null==(t=merchant_side_cart_params)?void 0:t.upsells_style)||a.hasClass("slick-initialized")||a.slick({infinite:!0,arrows:!0,slidesToShow:1,dots:!1,autoplay:!1,fade:!0,cssEase:"linear",pauseOnFocus:!0,pauseOnHover:!0,prevArrow:'<button type="button" class="slick-prev"><</button>',nextArrow:'<button type="button" class="slick-next">></button>',rtl:"1"===(null==(t=merchant_side_cart_params)?void 0:t.is_rtl)})},destroyCarousel:function(){var t,a=c(document).find(".merchant-mini-cart-upsells.upsells-layout-carousel");"carousel"===(null==(t=merchant_side_cart_params)?void 0:t.upsells_style)&&a.hasClass("slick-initialized")&&a.slick("unslick")},handleCouponBtnClick:function(t){t.preventDefault();var t=c(t.currentTarget).closest(".merchant-coupon-form"),a=t.find(".coupon_code").val();""!==a&&this.applyCoupon(this,a,t)},applyCoupon:function(a,t,e){var n,t={action:"merchant_side_cart_apply_coupon",coupon_code:t,nonce:null==(t=merchant_side_cart_params)?void 0:t.nonce};c.ajax({type:"POST",url:null==(n=merchant_side_cart_params)?void 0:n.ajax_url,data:t,beforeSend:function(){e.addClass("loading")},success:function(t){a.handleCouponSuccess(t)},error:function(t){a.handleCouponError(t)},complete:function(){e.removeClass("loading")}})},removeCoupon:function(a,t){var e,t={action:"merchant_side_cart_remove_coupon",coupon_code:t,nonce:null==(t=merchant_side_cart_params)?void 0:t.nonce};c.ajax({type:"POST",url:null==(e=merchant_side_cart_params)?void 0:e.ajax_url,data:t,beforeSend:function(){},success:function(t){a.handleCouponSuccess(t)},error:function(t){a.handleCouponError(t)}})},handleCouponSuccess:function(t){void 0!==t.fragments&&(c(document).trigger("merchant_destroy_carousel"),c(document.body).trigger("added_to_cart",[t.fragments,t.cart_hash,null,"side-cart"]),c(document).trigger("merchant_init_carousel"))},handleCouponError:function(t){console.log("Error:",t)},handleCouponRemoveClick:function(t){t.preventDefault();var t=c(t.currentTarget),a=t.attr("data-coupon");console.log(t),this.removeCoupon(this,a)},sideCartBtns:function(){var t="1"===(null==(t=merchant_side_cart_params)?void 0:t.show_checkout_btn),a="1"===(null==(a=merchant_side_cart_params)?void 0:a.show_view_cart_btn),e=null==(e=merchant_side_cart_params)?void 0:e.checkout_btn_text,n=null==(n=merchant_side_cart_params)?void 0:n.view_cart_btn_text,r=c(document).find(".merchant-floating-side-mini-cart-body .woocommerce-mini-cart__buttons"),o=r.find(".checkout"),r=r.find("a:not(.checkout)");(t||a)&&(""!==e&&o.text(e),""!==n)&&r.text(n)}}.init()});